<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>reagent.ope.estimators package &mdash; ReAgent 1.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="reagent.ope.test package" href="reagent.ope.test.html" />
    <link rel="prev" title="reagent.ope.datasets package" href="reagent.ope.datasets.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> ReAgent
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rasp_tutorial.html">RASP (Not Actively Maintained)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Topics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../continuous_integration.html">Continuous Integration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Package Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="reagent.core.html">Core</a></li>
<li class="toctree-l1"><a class="reference internal" href="reagent.data.html">Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="reagent.gym.html">Gym</a></li>
<li class="toctree-l1"><a class="reference internal" href="reagent.evaluation.html">Evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="reagent.lite.html">Lite</a></li>
<li class="toctree-l1"><a class="reference internal" href="reagent.mab.html">MAB</a></li>
<li class="toctree-l1"><a class="reference internal" href="reagent.model_managers.html">Model Managers</a></li>
<li class="toctree-l1"><a class="reference internal" href="reagent.model_utils.html">Model Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="reagent.net_builder.html">Net Builders</a></li>
<li class="toctree-l1"><a class="reference internal" href="reagent.optimizer.html">Optimizers</a></li>
<li class="toctree-l1"><a class="reference internal" href="reagent.models.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="reagent.prediction.html">Prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="reagent.preprocessing.html">Preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="reagent.training.html">Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="reagent.workflow.html">Workflow</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">All Modules</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="reagent.html">reagent package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="reagent.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="reagent.core.html">reagent.core package</a></li>
<li class="toctree-l4"><a class="reference internal" href="reagent.data.html">reagent.data package</a></li>
<li class="toctree-l4"><a class="reference internal" href="reagent.evaluation.html">reagent.evaluation package</a></li>
<li class="toctree-l4"><a class="reference internal" href="reagent.gym.html">reagent.gym package</a></li>
<li class="toctree-l4"><a class="reference internal" href="reagent.lite.html">reagent.lite package</a></li>
<li class="toctree-l4"><a class="reference internal" href="reagent.mab.html">reagent.mab package</a></li>
<li class="toctree-l4"><a class="reference internal" href="reagent.model_managers.html">reagent.model_managers package</a></li>
<li class="toctree-l4"><a class="reference internal" href="reagent.model_utils.html">reagent.model_utils package</a></li>
<li class="toctree-l4"><a class="reference internal" href="reagent.models.html">reagent.models package</a></li>
<li class="toctree-l4"><a class="reference internal" href="reagent.net_builder.html">reagent.net_builder package</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="reagent.ope.html">reagent.ope package</a></li>
<li class="toctree-l4"><a class="reference internal" href="reagent.optimizer.html">reagent.optimizer package</a></li>
<li class="toctree-l4"><a class="reference internal" href="reagent.prediction.html">reagent.prediction package</a></li>
<li class="toctree-l4"><a class="reference internal" href="reagent.preprocessing.html">reagent.preprocessing package</a></li>
<li class="toctree-l4"><a class="reference internal" href="reagent.publishers.html">reagent.publishers package</a></li>
<li class="toctree-l4"><a class="reference internal" href="reagent.replay_memory.html">reagent.replay_memory package</a></li>
<li class="toctree-l4"><a class="reference internal" href="reagent.reporting.html">reagent.reporting package</a></li>
<li class="toctree-l4"><a class="reference internal" href="reagent.samplers.html">reagent.samplers package</a></li>
<li class="toctree-l4"><a class="reference internal" href="reagent.scripts.html">reagent.scripts package</a></li>
<li class="toctree-l4"><a class="reference internal" href="reagent.training.html">reagent.training package</a></li>
<li class="toctree-l4"><a class="reference internal" href="reagent.validators.html">reagent.validators package</a></li>
<li class="toctree-l4"><a class="reference internal" href="reagent.workflow.html">reagent.workflow package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="reagent.html#module-reagent">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Others</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/facebookresearch/ReAgent">Github</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ReAgent</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="modules.html">reagent</a> &raquo;</li>
          <li><a href="reagent.html">reagent package</a> &raquo;</li>
          <li><a href="reagent.ope.html">reagent.ope package</a> &raquo;</li>
      <li>reagent.ope.estimators package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/reagent.ope.estimators.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="reagent-ope-estimators-package">
<h1>reagent.ope.estimators package<a class="headerlink" href="#reagent-ope-estimators-package" title="Permalink to this headline"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline"></a></h2>
</section>
<section id="module-reagent.ope.estimators.contextual_bandits_estimators">
<span id="reagent-ope-estimators-contextual-bandits-estimators-module"></span><h2>reagent.ope.estimators.contextual_bandits_estimators module<a class="headerlink" href="#module-reagent.ope.estimators.contextual_bandits_estimators" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.contextual_bandits_estimators.ActionRewards">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.contextual_bandits_estimators.</span></span><span class="sig-name descname"><span class="pre">ActionRewards</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">reagent.ope.estimators.types.KeyType</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.contextual_bandits_estimators.ActionRewards" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.types.Values" title="reagent.ope.estimators.types.Values"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.types.Values</span></code></a>[<a class="reference internal" href="#reagent.ope.estimators.types.TypeWrapper" title="reagent.ope.estimators.types.TypeWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.types.TypeWrapper</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code>]]]</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.contextual_bandits_estimators.BanditsEstimatorInput">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.contextual_bandits_estimators.</span></span><span class="sig-name descname"><span class="pre">BanditsEstimatorInput</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action_space</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.types.ActionSpace" title="reagent.ope.estimators.types.ActionSpace"><span class="pre">reagent.ope.estimators.types.ActionSpace</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.contextual_bandits_estimators.LogSample" title="reagent.ope.estimators.contextual_bandits_estimators.LogSample"><span class="pre">reagent.ope.estimators.contextual_bandits_estimators.LogSample</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_model_outputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.contextual_bandits_estimators.BanditsEstimatorInput" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.contextual_bandits_estimators.BanditsEstimatorInput.action_space">
<span class="sig-name descname"><span class="pre">action_space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#reagent.ope.estimators.types.ActionSpace" title="reagent.ope.estimators.types.ActionSpace"><span class="pre">reagent.ope.estimators.types.ActionSpace</span></a></em><a class="headerlink" href="#reagent.ope.estimators.contextual_bandits_estimators.BanditsEstimatorInput.action_space" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.contextual_bandits_estimators.BanditsEstimatorInput.has_model_outputs">
<span class="sig-name descname"><span class="pre">has_model_outputs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#reagent.ope.estimators.contextual_bandits_estimators.BanditsEstimatorInput.has_model_outputs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.contextual_bandits_estimators.BanditsEstimatorInput.samples">
<span class="sig-name descname"><span class="pre">samples</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.contextual_bandits_estimators.LogSample" title="reagent.ope.estimators.contextual_bandits_estimators.LogSample"><span class="pre">reagent.ope.estimators.contextual_bandits_estimators.LogSample</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#reagent.ope.estimators.contextual_bandits_estimators.BanditsEstimatorInput.samples" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.contextual_bandits_estimators.BanditsModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.contextual_bandits_estimators.</span></span><span class="sig-name descname"><span class="pre">BanditsModel</span></span><a class="headerlink" href="#reagent.ope.estimators.contextual_bandits_estimators.BanditsModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.contextual_bandits_estimators.DMEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.contextual_bandits_estimators.</span></span><span class="sig-name descname"><span class="pre">DMEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.types.Trainer" title="reagent.ope.estimators.types.Trainer"><span class="pre">reagent.ope.estimators.types.Trainer</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.contextual_bandits_estimators.DMEstimator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.estimator.Estimator" title="reagent.ope.estimators.estimator.Estimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.estimator.Estimator</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.contextual_bandits_estimators.DMEstimator.TRAINING_VALIDATION_SPLIT">
<span class="sig-name descname"><span class="pre">TRAINING_VALIDATION_SPLIT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.8</span></em><a class="headerlink" href="#reagent.ope.estimators.contextual_bandits_estimators.DMEstimator.TRAINING_VALIDATION_SPLIT" title="Permalink to this definition"></a></dt>
<dd><p>Estimating using Direct Method (DM), assuming a reward model is trained</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.contextual_bandits_estimators.DMEstimator.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.contextual_bandits_estimators.BanditsEstimatorInput" title="reagent.ope.estimators.contextual_bandits_estimators.BanditsEstimatorInput"><span class="pre">reagent.ope.estimators.contextual_bandits_estimators.BanditsEstimatorInput</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.estimator.EstimatorResult" title="reagent.ope.estimators.estimator.EstimatorResult"><span class="pre">reagent.ope.estimators.estimator.EstimatorResult</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#reagent.ope.estimators.contextual_bandits_estimators.DMEstimator.evaluate" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.contextual_bandits_estimators.DoublyRobustEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.contextual_bandits_estimators.</span></span><span class="sig-name descname"><span class="pre">DoublyRobustEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.types.Trainer" title="reagent.ope.estimators.types.Trainer"><span class="pre">reagent.ope.estimators.types.Trainer</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_clamper</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="reagent.ope.html#reagent.ope.utils.Clamper" title="reagent.ope.utils.Clamper"><span class="pre">reagent.ope.utils.Clamper</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.contextual_bandits_estimators.DoublyRobustEstimator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.contextual_bandits_estimators.DMEstimator" title="reagent.ope.estimators.contextual_bandits_estimators.DMEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.contextual_bandits_estimators.DMEstimator</span></code></a></p>
<dl class="simple">
<dt>Doubly Robust (DR) estimator:</dt><dd><dl class="simple">
<dt>reference: <a class="reference external" href="https://arxiv.org/abs/1103.4601">https://arxiv.org/abs/1103.4601</a> (deterministic reward model)</dt><dd><p><a class="reference external" href="https://arxiv.org/abs/1612.01205">https://arxiv.org/abs/1612.01205</a> (distributed reward model)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.contextual_bandits_estimators.IPSEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.contextual_bandits_estimators.</span></span><span class="sig-name descname"><span class="pre">IPSEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weight_clamper</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="reagent.ope.html#reagent.ope.utils.Clamper" title="reagent.ope.utils.Clamper"><span class="pre">reagent.ope.utils.Clamper</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.contextual_bandits_estimators.IPSEstimator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.estimator.Estimator" title="reagent.ope.estimators.estimator.Estimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.estimator.Estimator</span></code></a></p>
<p>Inverse Propensity Scoring (IPS) estimator</p>
<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.contextual_bandits_estimators.IPSEstimator.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.contextual_bandits_estimators.BanditsEstimatorInput" title="reagent.ope.estimators.contextual_bandits_estimators.BanditsEstimatorInput"><span class="pre">reagent.ope.estimators.contextual_bandits_estimators.BanditsEstimatorInput</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.estimator.EstimatorResult" title="reagent.ope.estimators.estimator.EstimatorResult"><span class="pre">reagent.ope.estimators.estimator.EstimatorResult</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#reagent.ope.estimators.contextual_bandits_estimators.IPSEstimator.evaluate" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.contextual_bandits_estimators.LogSample">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.contextual_bandits_estimators.</span></span><span class="sig-name descname"><span class="pre">LogSample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.types.TypeWrapper" title="reagent.ope.estimators.types.TypeWrapper"><span class="pre">reagent.ope.estimators.types.TypeWrapper</span></a><span class="p"><span class="pre">[</span></span><span class="pre">typing.Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">typing.Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">typing.Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_reward</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_action_probabilities</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.types.ActionDistribution" title="reagent.ope.estimators.types.ActionDistribution"><span class="pre">reagent.ope.estimators.types.ActionDistribution</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">tgt_action_probabilities</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.types.ActionDistribution" title="reagent.ope.estimators.types.ActionDistribution"><span class="pre">reagent.ope.estimators.types.ActionDistribution</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">tgt_action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.types.TypeWrapper" title="reagent.ope.estimators.types.TypeWrapper"><span class="pre">reagent.ope.estimators.types.TypeWrapper</span></a><span class="p"><span class="pre">[</span></span><span class="pre">typing.Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">typing.Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">typing.Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_outputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.contextual_bandits_estimators.ModelOutputs" title="reagent.ope.estimators.contextual_bandits_estimators.ModelOutputs"><span class="pre">reagent.ope.estimators.contextual_bandits_estimators.ModelOutputs</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ground_truth_reward</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_feature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.contextual_bandits_estimators.LogSample" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.contextual_bandits_estimators.LogSample.context">
<span class="sig-name descname"><span class="pre">context</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">object</span></em><a class="headerlink" href="#reagent.ope.estimators.contextual_bandits_estimators.LogSample.context" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.contextual_bandits_estimators.LogSample.ground_truth_reward">
<span class="sig-name descname"><span class="pre">ground_truth_reward</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">nan</span></em><a class="headerlink" href="#reagent.ope.estimators.contextual_bandits_estimators.LogSample.ground_truth_reward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.contextual_bandits_estimators.LogSample.item_feature">
<span class="sig-name descname"><span class="pre">item_feature</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#reagent.ope.estimators.contextual_bandits_estimators.LogSample.item_feature" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.contextual_bandits_estimators.LogSample.log_action">
<span class="sig-name descname"><span class="pre">log_action</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#reagent.ope.estimators.types.TypeWrapper" title="reagent.ope.estimators.types.TypeWrapper"><span class="pre">reagent.ope.estimators.types.TypeWrapper</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#reagent.ope.estimators.contextual_bandits_estimators.LogSample.log_action" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.contextual_bandits_estimators.LogSample.log_action_probabilities">
<span class="sig-name descname"><span class="pre">log_action_probabilities</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#reagent.ope.estimators.types.ActionDistribution" title="reagent.ope.estimators.types.ActionDistribution"><span class="pre">reagent.ope.estimators.types.ActionDistribution</span></a></em><a class="headerlink" href="#reagent.ope.estimators.contextual_bandits_estimators.LogSample.log_action_probabilities" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.contextual_bandits_estimators.LogSample.log_reward">
<span class="sig-name descname"><span class="pre">log_reward</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#reagent.ope.estimators.contextual_bandits_estimators.LogSample.log_reward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.contextual_bandits_estimators.LogSample.model_outputs">
<span class="sig-name descname"><span class="pre">model_outputs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.contextual_bandits_estimators.ModelOutputs" title="reagent.ope.estimators.contextual_bandits_estimators.ModelOutputs"><span class="pre">reagent.ope.estimators.contextual_bandits_estimators.ModelOutputs</span></a><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#reagent.ope.estimators.contextual_bandits_estimators.LogSample.model_outputs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.contextual_bandits_estimators.LogSample.tgt_action">
<span class="sig-name descname"><span class="pre">tgt_action</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#reagent.ope.estimators.types.TypeWrapper" title="reagent.ope.estimators.types.TypeWrapper"><span class="pre">reagent.ope.estimators.types.TypeWrapper</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#reagent.ope.estimators.contextual_bandits_estimators.LogSample.tgt_action" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.contextual_bandits_estimators.LogSample.tgt_action_probabilities">
<span class="sig-name descname"><span class="pre">tgt_action_probabilities</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#reagent.ope.estimators.types.ActionDistribution" title="reagent.ope.estimators.types.ActionDistribution"><span class="pre">reagent.ope.estimators.types.ActionDistribution</span></a></em><a class="headerlink" href="#reagent.ope.estimators.contextual_bandits_estimators.LogSample.tgt_action_probabilities" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.contextual_bandits_estimators.ModelOutputs">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.contextual_bandits_estimators.</span></span><span class="sig-name descname"><span class="pre">ModelOutputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tgt_reward_from_log_action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tgt_rewards</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.contextual_bandits_estimators.ModelOutputs" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.contextual_bandits_estimators.ModelOutputs.tgt_reward_from_log_action">
<span class="sig-name descname"><span class="pre">tgt_reward_from_log_action</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#reagent.ope.estimators.contextual_bandits_estimators.ModelOutputs.tgt_reward_from_log_action" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.contextual_bandits_estimators.ModelOutputs.tgt_rewards">
<span class="sig-name descname"><span class="pre">tgt_rewards</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#reagent.ope.estimators.contextual_bandits_estimators.ModelOutputs.tgt_rewards" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.contextual_bandits_estimators.SwitchDREstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.contextual_bandits_estimators.</span></span><span class="sig-name descname"><span class="pre">SwitchDREstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.types.Trainer" title="reagent.ope.estimators.types.Trainer"><span class="pre">reagent.ope.estimators.types.Trainer</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_clamper</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="reagent.ope.html#reagent.ope.utils.Clamper" title="reagent.ope.utils.Clamper"><span class="pre">reagent.ope.utils.Clamper</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.contextual_bandits_estimators.SwitchDREstimator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.contextual_bandits_estimators.SwitchEstimator" title="reagent.ope.estimators.contextual_bandits_estimators.SwitchEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.contextual_bandits_estimators.SwitchEstimator</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.contextual_bandits_estimators.SwitchEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.contextual_bandits_estimators.</span></span><span class="sig-name descname"><span class="pre">SwitchEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.types.Trainer" title="reagent.ope.estimators.types.Trainer"><span class="pre">reagent.ope.estimators.types.Trainer</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_clamper</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="reagent.ope.html#reagent.ope.utils.Clamper" title="reagent.ope.utils.Clamper"><span class="pre">reagent.ope.utils.Clamper</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.contextual_bandits_estimators.SwitchEstimator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.contextual_bandits_estimators.DMEstimator" title="reagent.ope.estimators.contextual_bandits_estimators.DMEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.contextual_bandits_estimators.DMEstimator</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.contextual_bandits_estimators.SwitchEstimator.CANDIDATES">
<span class="sig-name descname"><span class="pre">CANDIDATES</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">21</span></em><a class="headerlink" href="#reagent.ope.estimators.contextual_bandits_estimators.SwitchEstimator.CANDIDATES" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.contextual_bandits_estimators.SwitchEstimator.EPSILON">
<span class="sig-name descname"><span class="pre">EPSILON</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-06</span></em><a class="headerlink" href="#reagent.ope.estimators.contextual_bandits_estimators.SwitchEstimator.EPSILON" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.contextual_bandits_estimators.SwitchEstimator.EXP_BASE">
<span class="sig-name descname"><span class="pre">EXP_BASE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.5</span></em><a class="headerlink" href="#reagent.ope.estimators.contextual_bandits_estimators.SwitchEstimator.EXP_BASE" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-reagent.ope.estimators.estimator">
<span id="reagent-ope-estimators-estimator-module"></span><h2>reagent.ope.estimators.estimator module<a class="headerlink" href="#module-reagent.ope.estimators.estimator" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.estimator.Estimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.estimator.</span></span><span class="sig-name descname"><span class="pre">Estimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.estimator.Estimator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Estimator interface</p>
<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.estimator.Estimator.evaluate">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.estimator.EstimatorResult" title="reagent.ope.estimators.estimator.EstimatorResult"><span class="pre">reagent.ope.estimators.estimator.EstimatorResult</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#reagent.ope.estimators.estimator.EstimatorResults" title="reagent.ope.estimators.estimator.EstimatorResults"><span class="pre">reagent.ope.estimators.estimator.EstimatorResults</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#reagent.ope.estimators.estimator.Estimator.evaluate" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.estimator.EstimatorResult">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.estimator.</span></span><span class="sig-name descname"><span class="pre">EstimatorResult</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_reward</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimated_reward</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ground_truth_reward</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimated_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimated_reward_normalized</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimated_reward_std_error</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimated_reward_normalized_std_error</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.estimator.EstimatorResult" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.estimator.EstimatorResult.estimated_reward">
<span class="sig-name descname"><span class="pre">estimated_reward</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#reagent.ope.estimators.estimator.EstimatorResult.estimated_reward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.estimator.EstimatorResult.estimated_reward_normalized">
<span class="sig-name descname"><span class="pre">estimated_reward_normalized</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#reagent.ope.estimators.estimator.EstimatorResult.estimated_reward_normalized" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.estimator.EstimatorResult.estimated_reward_normalized_std_error">
<span class="sig-name descname"><span class="pre">estimated_reward_normalized_std_error</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#reagent.ope.estimators.estimator.EstimatorResult.estimated_reward_normalized_std_error" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.estimator.EstimatorResult.estimated_reward_std_error">
<span class="sig-name descname"><span class="pre">estimated_reward_std_error</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#reagent.ope.estimators.estimator.EstimatorResult.estimated_reward_std_error" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.estimator.EstimatorResult.estimated_weight">
<span class="sig-name descname"><span class="pre">estimated_weight</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#reagent.ope.estimators.estimator.EstimatorResult.estimated_weight" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.estimator.EstimatorResult.ground_truth_reward">
<span class="sig-name descname"><span class="pre">ground_truth_reward</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#reagent.ope.estimators.estimator.EstimatorResult.ground_truth_reward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.estimator.EstimatorResult.log_reward">
<span class="sig-name descname"><span class="pre">log_reward</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#reagent.ope.estimators.estimator.EstimatorResult.log_reward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.estimator.EstimatorResults">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.estimator.</span></span><span class="sig-name descname"><span class="pre">EstimatorResults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">results:</span> <span class="pre">List[reagent.ope.estimators.estimator.EstimatorResult]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.estimator.EstimatorResults" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Estimator results</p>
<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.estimator.EstimatorResults.append">
<span class="sig-name descname"><span class="pre">append</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.estimator.EstimatorResult" title="reagent.ope.estimators.estimator.EstimatorResult"><span class="pre">reagent.ope.estimators.estimator.EstimatorResult</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.estimator.EstimatorResults.append" title="Permalink to this definition"></a></dt>
<dd><p>Append a data point</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>result</strong> – result from an experimental run</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.estimator.EstimatorResults.device">
<span class="sig-name descname"><span class="pre">device</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#reagent.ope.estimators.estimator.EstimatorResults.device" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.estimator.EstimatorResults.report">
<span class="sig-name descname"><span class="pre">report</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.estimator.EstimatorResults.report" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.estimator.EstimatorResults.results">
<span class="sig-name descname"><span class="pre">results</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.estimator.EstimatorResult" title="reagent.ope.estimators.estimator.EstimatorResult"><span class="pre">reagent.ope.estimators.estimator.EstimatorResult</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#reagent.ope.estimators.estimator.EstimatorResults.results" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.estimator.EstimatorSampleResult">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.estimator.</span></span><span class="sig-name descname"><span class="pre">EstimatorSampleResult</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_reward</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_reward</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ground_truth_reward</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.estimator.EstimatorSampleResult" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.estimator.EstimatorSampleResult.ground_truth_reward">
<span class="sig-name descname"><span class="pre">ground_truth_reward</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#reagent.ope.estimators.estimator.EstimatorSampleResult.ground_truth_reward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.estimator.EstimatorSampleResult.log_reward">
<span class="sig-name descname"><span class="pre">log_reward</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#reagent.ope.estimators.estimator.EstimatorSampleResult.log_reward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.estimator.EstimatorSampleResult.target_reward">
<span class="sig-name descname"><span class="pre">target_reward</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#reagent.ope.estimators.estimator.EstimatorSampleResult.target_reward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.estimator.EstimatorSampleResult.weight">
<span class="sig-name descname"><span class="pre">weight</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#reagent.ope.estimators.estimator.EstimatorSampleResult.weight" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.estimator.Evaluator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.estimator.</span></span><span class="sig-name descname"><span class="pre">Evaluator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.estimator.Estimator" title="reagent.ope.estimators.estimator.Estimator"><span class="pre">reagent.ope.estimators.estimator.Estimator</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">object</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.estimator.Evaluator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Multiprocessing evaluator</p>
<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.estimator.Evaluator.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#reagent.ope.estimators.estimator.EstimatorResults" title="reagent.ope.estimators.estimator.EstimatorResults"><span class="pre">reagent.ope.estimators.estimator.EstimatorResults</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#reagent.ope.estimators.estimator.Evaluator.evaluate" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.estimator.Evaluator.report_results">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">report_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">results</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#reagent.ope.estimators.estimator.EstimatorResults" title="reagent.ope.estimators.estimator.EstimatorResults"><span class="pre">reagent.ope.estimators.estimator.EstimatorResults</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.estimator.Evaluator.report_results" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.estimator.ResultDiffs">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.estimator.</span></span><span class="sig-name descname"><span class="pre">ResultDiffs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">diffs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.estimator.ResultDiffs" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Statistics for differences, e.g., estimates vs ground truth</p>
<dl class="py property">
<dt class="sig sig-object py" id="reagent.ope.estimators.estimator.ResultDiffs.bias">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bias</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></em><a class="headerlink" href="#reagent.ope.estimators.estimator.ResultDiffs.bias" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="reagent.ope.estimators.estimator.ResultDiffs.rmse">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rmse</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></em><a class="headerlink" href="#reagent.ope.estimators.estimator.ResultDiffs.rmse" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="reagent.ope.estimators.estimator.ResultDiffs.variance">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">variance</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></em><a class="headerlink" href="#reagent.ope.estimators.estimator.ResultDiffs.variance" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reagent.ope.estimators.estimator.run_evaluation">
<span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.estimator.</span></span><span class="sig-name descname"><span class="pre">run_evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.estimator.EstimatorResults" title="reagent.ope.estimators.estimator.EstimatorResults"><span class="pre">reagent.ope.estimators.estimator.EstimatorResults</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#reagent.ope.estimators.estimator.run_evaluation" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-reagent.ope.estimators.sequential_estimators">
<span id="reagent-ope-estimators-sequential-estimators-module"></span><h2>reagent.ope.estimators.sequential_estimators module<a class="headerlink" href="#module-reagent.ope.estimators.sequential_estimators" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.DMEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.sequential_estimators.</span></span><span class="sig-name descname"><span class="pre">DMEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.DMEstimator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.sequential_estimators.RLEstimator" title="reagent.ope.estimators.sequential_estimators.RLEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.sequential_estimators.RLEstimator</span></code></a></p>
<p>Direct Method estimator</p>
<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.DMEstimator.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.sequential_estimators.RLEstimatorInput" title="reagent.ope.estimators.sequential_estimators.RLEstimatorInput"><span class="pre">reagent.ope.estimators.sequential_estimators.RLEstimatorInput</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#reagent.ope.estimators.estimator.EstimatorResults" title="reagent.ope.estimators.estimator.EstimatorResults"><span class="pre">reagent.ope.estimators.estimator.EstimatorResults</span></a></span></span><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.DMEstimator.evaluate" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.DoublyRobustEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.sequential_estimators.</span></span><span class="sig-name descname"><span class="pre">DoublyRobustEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weight_clamper</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="reagent.ope.html#reagent.ope.utils.Clamper" title="reagent.ope.utils.Clamper"><span class="pre">reagent.ope.utils.Clamper</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.DoublyRobustEstimator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.sequential_estimators.IPSEstimator" title="reagent.ope.estimators.sequential_estimators.IPSEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.sequential_estimators.IPSEstimator</span></code></a></p>
<p>Doubly Robust estimator</p>
<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.DoublyRobustEstimator.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.sequential_estimators.RLEstimatorInput" title="reagent.ope.estimators.sequential_estimators.RLEstimatorInput"><span class="pre">reagent.ope.estimators.sequential_estimators.RLEstimatorInput</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#reagent.ope.estimators.estimator.EstimatorResults" title="reagent.ope.estimators.estimator.EstimatorResults"><span class="pre">reagent.ope.estimators.estimator.EstimatorResults</span></a></span></span><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.DoublyRobustEstimator.evaluate" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.EpsilonGreedyRLPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.sequential_estimators.</span></span><span class="sig-name descname"><span class="pre">EpsilonGreedyRLPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.sequential_estimators.RLPolicy" title="reagent.ope.estimators.sequential_estimators.RLPolicy"><span class="pre">reagent.ope.estimators.sequential_estimators.RLPolicy</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.EpsilonGreedyRLPolicy" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.sequential_estimators.RLPolicy" title="reagent.ope.estimators.sequential_estimators.RLPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.sequential_estimators.RLPolicy</span></code></a></p>
<dl class="simple">
<dt>A wrapper policy:</dt><dd><p>Skewing the wrapped policy action distribution by epsilon
Number of total actions must be given, and wrapped policy should
calculate probabilities for all actions</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.EpsilonGreedyRLPolicy.action_dist">
<span class="sig-name descname"><span class="pre">action_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#reagent.ope.estimators.types.ActionDistribution" title="reagent.ope.estimators.types.ActionDistribution"><span class="pre">reagent.ope.estimators.types.ActionDistribution</span></a></span></span><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.EpsilonGreedyRLPolicy.action_dist" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.IPSEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.sequential_estimators.</span></span><span class="sig-name descname"><span class="pre">IPSEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weight_clamper</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="reagent.ope.html#reagent.ope.utils.Clamper" title="reagent.ope.utils.Clamper"><span class="pre">reagent.ope.utils.Clamper</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.IPSEstimator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.sequential_estimators.RLEstimator" title="reagent.ope.estimators.sequential_estimators.RLEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.sequential_estimators.RLEstimator</span></code></a></p>
<p>IPS estimator</p>
<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.IPSEstimator.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.sequential_estimators.RLEstimatorInput" title="reagent.ope.estimators.sequential_estimators.RLEstimatorInput"><span class="pre">reagent.ope.estimators.sequential_estimators.RLEstimatorInput</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#reagent.ope.estimators.estimator.EstimatorResults" title="reagent.ope.estimators.estimator.EstimatorResults"><span class="pre">reagent.ope.estimators.estimator.EstimatorResults</span></a></span></span><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.IPSEstimator.evaluate" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.MAGICEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.sequential_estimators.</span></span><span class="sig-name descname"><span class="pre">MAGICEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weight_clamper</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="reagent.ope.html#reagent.ope.utils.Clamper" title="reagent.ope.utils.Clamper"><span class="pre">reagent.ope.utils.Clamper</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.MAGICEstimator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.sequential_estimators.IPSEstimator" title="reagent.ope.estimators.sequential_estimators.IPSEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.sequential_estimators.IPSEstimator</span></code></a></p>
<p>Algorithm from <a class="reference external" href="https://arxiv.org/abs/1604.00923">https://arxiv.org/abs/1604.00923</a>, appendix G.3</p>
<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.MAGICEstimator.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.sequential_estimators.RLEstimatorInput" title="reagent.ope.estimators.sequential_estimators.RLEstimatorInput"><span class="pre">reagent.ope.estimators.sequential_estimators.RLEstimatorInput</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#reagent.ope.estimators.estimator.EstimatorResults" title="reagent.ope.estimators.estimator.EstimatorResults"><span class="pre">reagent.ope.estimators.estimator.EstimatorResults</span></a></span></span><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.MAGICEstimator.evaluate" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.Model">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.sequential_estimators.</span></span><span class="sig-name descname"><span class="pre">Model</span></span><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.Model" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Model interface</p>
<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.Model.next_state_reward_dist">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">next_state_reward_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.sequential_estimators.State" title="reagent.ope.estimators.sequential_estimators.State"><span class="pre">reagent.ope.estimators.sequential_estimators.State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.types.TypeWrapper" title="reagent.ope.estimators.types.TypeWrapper"><span class="pre">reagent.ope.estimators.types.TypeWrapper</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.sequential_estimators.State" title="reagent.ope.estimators.sequential_estimators.State"><span class="pre">reagent.ope.estimators.sequential_estimators.State</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#reagent.ope.estimators.sequential_estimators.RewardProbability" title="reagent.ope.estimators.sequential_estimators.RewardProbability"><span class="pre">reagent.ope.estimators.sequential_estimators.RewardProbability</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.Model.next_state_reward_dist" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.NeuralDualDICE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.sequential_estimators.</span></span><span class="sig-name descname"><span class="pre">NeuralDualDICE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic_env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average_next_v</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polynomial_degree</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_lr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zeta_lr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_layers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2048</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_callback_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#reagent.ope.estimators.sequential_estimators.RLEstimator" title="reagent.ope.estimators.sequential_estimators.RLEstimator"><span class="pre">reagent.ope.estimators.sequential_estimators.RLEstimator</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reporting_frequency</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zeta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fconjugate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zeta_net</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_net</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.NeuralDualDICE" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.sequential_estimators.RLEstimator" title="reagent.ope.estimators.sequential_estimators.RLEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.sequential_estimators.RLEstimator</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_dim</strong> – The dimensionality of the state vectors</p></li>
<li><p><strong>action_dim</strong> – The number of discrete actions</p></li>
<li><p><strong>deterministic_env</strong> – Whether or not the environment is determinstic.
Can help with stability of training.</p></li>
<li><p><strong>average_next_v</strong> – Whether or not to average the next nu value over all
possible actions. Can help with stability of training.</p></li>
<li><p><strong>polynomial_degree</strong> – The degree of the convex function f(x) = 1/p * <a href="#id1"><span class="problematic" id="id2">|</span></a>x|^p</p></li>
<li><p><strong>value_lr</strong> – The learning rate for nu</p></li>
<li><p><strong>zeta_lr</strong> – The learning rate for zeta</p></li>
<li><p><strong>hidden_dim</strong> – The dimensionality of the hidden layers for zeta and v</p></li>
<li><p><strong>hidden_layers</strong> – The number of hidden layers for zeta and v</p></li>
<li><p><strong>activation</strong> – The activation function for zeta and v</p></li>
<li><p><strong>training_samples</strong> – The number of batches to train zeta and v for</p></li>
<li><p><strong>batch_size</strong> – The number of samples in each batch</p></li>
<li><p><strong>loss_callback_fn</strong> – A function that will be called every reporting_frequency batches,
giving the average zeta loss, average nu loss, and self</p></li>
<li><p><strong>reporting_frequency</strong> – The number of batches between outputting the state of the training</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.NeuralDualDICE.action_dim">
<span class="sig-name descname"><span class="pre">action_dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.NeuralDualDICE.action_dim" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.NeuralDualDICE.activation">
<span class="sig-name descname"><span class="pre">activation</span></span><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.NeuralDualDICE.activation" title="Permalink to this definition"></a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.activation.Tanh</span></code></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.NeuralDualDICE.average_next_v">
<span class="sig-name descname"><span class="pre">average_next_v</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.NeuralDualDICE.average_next_v" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.NeuralDualDICE.batch_size">
<span class="sig-name descname"><span class="pre">batch_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2048</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.NeuralDualDICE.batch_size" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.NeuralDualDICE.deterministic_env">
<span class="sig-name descname"><span class="pre">deterministic_env</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.NeuralDualDICE.deterministic_env" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.NeuralDualDICE.device">
<span class="sig-name descname"><span class="pre">device</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.NeuralDualDICE.device" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.NeuralDualDICE.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.sequential_estimators.RLEstimatorInput" title="reagent.ope.estimators.sequential_estimators.RLEstimatorInput"><span class="pre">reagent.ope.estimators.sequential_estimators.RLEstimatorInput</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#reagent.ope.estimators.estimator.EstimatorResults" title="reagent.ope.estimators.estimator.EstimatorResults"><span class="pre">reagent.ope.estimators.estimator.EstimatorResults</span></a></span></span><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.NeuralDualDICE.evaluate" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.NeuralDualDICE.f">
<span class="sig-name descname"><span class="pre">f</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.NeuralDualDICE.f" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.NeuralDualDICE.fconjugate">
<span class="sig-name descname"><span class="pre">fconjugate</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.NeuralDualDICE.fconjugate" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.NeuralDualDICE.hidden_dim">
<span class="sig-name descname"><span class="pre">hidden_dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">64</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.NeuralDualDICE.hidden_dim" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.NeuralDualDICE.hidden_layers">
<span class="sig-name descname"><span class="pre">hidden_layers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.NeuralDualDICE.hidden_layers" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.NeuralDualDICE.loss_callback_fn">
<span class="sig-name descname"><span class="pre">loss_callback_fn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#reagent.ope.estimators.sequential_estimators.RLEstimator" title="reagent.ope.estimators.sequential_estimators.RLEstimator"><span class="pre">reagent.ope.estimators.sequential_estimators.RLEstimator</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.NeuralDualDICE.loss_callback_fn" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.NeuralDualDICE.polynomial_degree">
<span class="sig-name descname"><span class="pre">polynomial_degree</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.5</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.NeuralDualDICE.polynomial_degree" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.NeuralDualDICE.reporting_frequency">
<span class="sig-name descname"><span class="pre">reporting_frequency</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1000</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.NeuralDualDICE.reporting_frequency" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.NeuralDualDICE.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.NeuralDualDICE.reset" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.NeuralDualDICE.state_dim">
<span class="sig-name descname"><span class="pre">state_dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.NeuralDualDICE.state_dim" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.NeuralDualDICE.training_samples">
<span class="sig-name descname"><span class="pre">training_samples</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">100000</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.NeuralDualDICE.training_samples" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.NeuralDualDICE.v">
<span class="sig-name descname"><span class="pre">v</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.NeuralDualDICE.v" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.NeuralDualDICE.v_net">
<span class="sig-name descname"><span class="pre">v_net</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.NeuralDualDICE.v_net" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.NeuralDualDICE.value_lr">
<span class="sig-name descname"><span class="pre">value_lr</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.01</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.NeuralDualDICE.value_lr" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.NeuralDualDICE.zeta">
<span class="sig-name descname"><span class="pre">zeta</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.NeuralDualDICE.zeta" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.NeuralDualDICE.zeta_lr">
<span class="sig-name descname"><span class="pre">zeta_lr</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.01</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.NeuralDualDICE.zeta_lr" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.NeuralDualDICE.zeta_net">
<span class="sig-name descname"><span class="pre">zeta_net</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.NeuralDualDICE.zeta_net" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.RLEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.sequential_estimators.</span></span><span class="sig-name descname"><span class="pre">RLEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.RLEstimator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.estimator.Estimator" title="reagent.ope.estimators.estimator.Estimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.estimator.Estimator</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.RLEstimatorInput">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.sequential_estimators.</span></span><span class="sig-name descname"><span class="pre">RLEstimatorInput</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.sequential_estimators.Transition" title="reagent.ope.estimators.sequential_estimators.Transition"><span class="pre">reagent.ope.estimators.sequential_estimators.Transition</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.sequential_estimators.RLPolicy" title="reagent.ope.estimators.sequential_estimators.RLPolicy"><span class="pre">reagent.ope.estimators.sequential_estimators.RLPolicy</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.sequential_estimators.ValueFunction" title="reagent.ope.estimators.sequential_estimators.ValueFunction"><span class="pre">reagent.ope.estimators.sequential_estimators.ValueFunction</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ground_truth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.sequential_estimators.ValueFunction" title="reagent.ope.estimators.sequential_estimators.ValueFunction"><span class="pre">reagent.ope.estimators.sequential_estimators.ValueFunction</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">horizon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discrete_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.RLEstimatorInput" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.RLEstimatorInput.discrete_states">
<span class="sig-name descname"><span class="pre">discrete_states</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.RLEstimatorInput.discrete_states" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.RLEstimatorInput.gamma">
<span class="sig-name descname"><span class="pre">gamma</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.RLEstimatorInput.gamma" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.RLEstimatorInput.ground_truth">
<span class="sig-name descname"><span class="pre">ground_truth</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.sequential_estimators.ValueFunction" title="reagent.ope.estimators.sequential_estimators.ValueFunction"><span class="pre">reagent.ope.estimators.sequential_estimators.ValueFunction</span></a><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.RLEstimatorInput.ground_truth" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.RLEstimatorInput.horizon">
<span class="sig-name descname"><span class="pre">horizon</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">-1</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.RLEstimatorInput.horizon" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.RLEstimatorInput.log">
<span class="sig-name descname"><span class="pre">log</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.sequential_estimators.Transition" title="reagent.ope.estimators.sequential_estimators.Transition"><span class="pre">reagent.ope.estimators.sequential_estimators.Transition</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.RLEstimatorInput.log" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.RLEstimatorInput.target_policy">
<span class="sig-name descname"><span class="pre">target_policy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#reagent.ope.estimators.sequential_estimators.RLPolicy" title="reagent.ope.estimators.sequential_estimators.RLPolicy"><span class="pre">reagent.ope.estimators.sequential_estimators.RLPolicy</span></a></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.RLEstimatorInput.target_policy" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.RLEstimatorInput.value_function">
<span class="sig-name descname"><span class="pre">value_function</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.sequential_estimators.ValueFunction" title="reagent.ope.estimators.sequential_estimators.ValueFunction"><span class="pre">reagent.ope.estimators.sequential_estimators.ValueFunction</span></a><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.RLEstimatorInput.value_function" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.RLPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.sequential_estimators.</span></span><span class="sig-name descname"><span class="pre">RLPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action_space</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.types.ActionSpace" title="reagent.ope.estimators.types.ActionSpace"><span class="pre">reagent.ope.estimators.types.ActionSpace</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.RLPolicy" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Policy interface</p>
<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.RLPolicy.action_dist">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">action_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.sequential_estimators.State" title="reagent.ope.estimators.sequential_estimators.State"><span class="pre">reagent.ope.estimators.sequential_estimators.State</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#reagent.ope.estimators.types.ActionDistribution" title="reagent.ope.estimators.types.ActionDistribution"><span class="pre">reagent.ope.estimators.types.ActionDistribution</span></a></span></span><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.RLPolicy.action_dist" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.RLPolicy.action_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">action_space</span></span><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.RLPolicy.action_space" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.RandomRLPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.sequential_estimators.</span></span><span class="sig-name descname"><span class="pre">RandomRLPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action_space</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.types.ActionSpace" title="reagent.ope.estimators.types.ActionSpace"><span class="pre">reagent.ope.estimators.types.ActionSpace</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.RandomRLPolicy" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.sequential_estimators.RLPolicy" title="reagent.ope.estimators.sequential_estimators.RLPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.sequential_estimators.RLPolicy</span></code></a></p>
<p>A random policy which return an action according to uniform distribution</p>
<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.RandomRLPolicy.action_dist">
<span class="sig-name descname"><span class="pre">action_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.sequential_estimators.State" title="reagent.ope.estimators.sequential_estimators.State"><span class="pre">reagent.ope.estimators.sequential_estimators.State</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#reagent.ope.estimators.types.ActionDistribution" title="reagent.ope.estimators.types.ActionDistribution"><span class="pre">reagent.ope.estimators.types.ActionDistribution</span></a></span></span><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.RandomRLPolicy.action_dist" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.RewardProbability">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.sequential_estimators.</span></span><span class="sig-name descname"><span class="pre">RewardProbability</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reward</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prob</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.RewardProbability" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.RewardProbability.prob">
<span class="sig-name descname"><span class="pre">prob</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.RewardProbability.prob" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.RewardProbability.reward">
<span class="sig-name descname"><span class="pre">reward</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.RewardProbability.reward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.State">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.sequential_estimators.</span></span><span class="sig-name descname"><span class="pre">State</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">~</span> <span class="pre">ValueType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_terminal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.State" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.types.TypeWrapper" title="reagent.ope.estimators.types.TypeWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.types.TypeWrapper</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code>]]</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.State.is_terminal">
<span class="sig-name descname"><span class="pre">is_terminal</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.State.is_terminal" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.StateReward">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.sequential_estimators.</span></span><span class="sig-name descname"><span class="pre">StateReward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.sequential_estimators.State" title="reagent.ope.estimators.sequential_estimators.State"><span class="pre">reagent.ope.estimators.sequential_estimators.State</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.StateReward" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.StateReward.reward">
<span class="sig-name descname"><span class="pre">reward</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.StateReward.reward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.StateReward.state">
<span class="sig-name descname"><span class="pre">state</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.sequential_estimators.State" title="reagent.ope.estimators.sequential_estimators.State"><span class="pre">reagent.ope.estimators.sequential_estimators.State</span></a><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.StateReward.state" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.Transition">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.sequential_estimators.</span></span><span class="sig-name descname"><span class="pre">Transition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">last_state:</span> <span class="pre">Optional[reagent.ope.estimators.sequential_estimators.State]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">action:</span> <span class="pre">Optional[reagent.ope.estimators.types.TypeWrapper[Union[int,</span> <span class="pre">Tuple[int],</span> <span class="pre">float,</span> <span class="pre">Tuple[float],</span> <span class="pre">numpy.ndarray,</span> <span class="pre">torch.Tensor]]]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">action_prob:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.0,</span> <span class="pre">state:</span> <span class="pre">Optional[reagent.ope.estimators.sequential_estimators.State]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">reward:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.0,</span> <span class="pre">status:</span> <span class="pre">reagent.ope.estimators.sequential_estimators.Transition.Status</span> <span class="pre">=</span> <span class="pre">&lt;Status.NORMAL:</span> <span class="pre">1&gt;</span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.Transition" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.Transition.Status">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Status</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.Transition.Status" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></p>
<p>An enumeration.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.Transition.Status.NOOP">
<span class="sig-name descname"><span class="pre">NOOP</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.Transition.Status.NOOP" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.Transition.Status.NORMAL">
<span class="sig-name descname"><span class="pre">NORMAL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.Transition.Status.NORMAL" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.Transition.Status.TERMINATED">
<span class="sig-name descname"><span class="pre">TERMINATED</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.Transition.Status.TERMINATED" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.Transition.action">
<span class="sig-name descname"><span class="pre">action</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.types.TypeWrapper" title="reagent.ope.estimators.types.TypeWrapper"><span class="pre">reagent.ope.estimators.types.TypeWrapper</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.Transition.action" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.Transition.action_prob">
<span class="sig-name descname"><span class="pre">action_prob</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.Transition.action_prob" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.Transition.last_state">
<span class="sig-name descname"><span class="pre">last_state</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.sequential_estimators.State" title="reagent.ope.estimators.sequential_estimators.State"><span class="pre">reagent.ope.estimators.sequential_estimators.State</span></a><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.Transition.last_state" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.Transition.reward">
<span class="sig-name descname"><span class="pre">reward</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.Transition.reward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.Transition.state">
<span class="sig-name descname"><span class="pre">state</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.sequential_estimators.State" title="reagent.ope.estimators.sequential_estimators.State"><span class="pre">reagent.ope.estimators.sequential_estimators.State</span></a><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.Transition.state" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.Transition.status">
<span class="sig-name descname"><span class="pre">status</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#reagent.ope.estimators.sequential_estimators.Transition.Status" title="reagent.ope.estimators.sequential_estimators.Transition.Status"><span class="pre">reagent.ope.estimators.sequential_estimators.Transition.Status</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.Transition.status" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.ValueFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.sequential_estimators.</span></span><span class="sig-name descname"><span class="pre">ValueFunction</span></span><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.ValueFunction" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Value function to calculate state and state-action values</p>
<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.ValueFunction.reset">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.ValueFunction.reset" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.ValueFunction.state_action_value">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">state_action_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.sequential_estimators.State" title="reagent.ope.estimators.sequential_estimators.State"><span class="pre">reagent.ope.estimators.sequential_estimators.State</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.types.TypeWrapper" title="reagent.ope.estimators.types.TypeWrapper"><span class="pre">reagent.ope.estimators.types.TypeWrapper</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.ValueFunction.state_action_value" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.sequential_estimators.ValueFunction.state_value">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">state_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.sequential_estimators.State" title="reagent.ope.estimators.sequential_estimators.State"><span class="pre">reagent.ope.estimators.sequential_estimators.State</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#reagent.ope.estimators.sequential_estimators.ValueFunction.state_value" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-reagent.ope.estimators.slate_estimators">
<span id="reagent-ope-estimators-slate-estimators-module"></span><h2>reagent.ope.estimators.slate_estimators module<a class="headerlink" href="#module-reagent.ope.estimators.slate_estimators" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.DCGSlateMetric">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.slate_estimators.</span></span><span class="sig-name descname"><span class="pre">DCGSlateMetric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.DCGSlateMetric" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateMetric" title="reagent.ope.estimators.slate_estimators.SlateMetric"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.slate_estimators.SlateMetric</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.DCGSlateMetric.slot_values">
<span class="sig-name descname"><span class="pre">slot_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rewards</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlotValues" title="reagent.ope.estimators.slate_estimators.SlateSlotValues"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlotValues</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlotValues" title="reagent.ope.estimators.slate_estimators.SlateSlotValues"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlotValues</span></a></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.DCGSlateMetric.slot_values" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.DCGSlateMetric.slot_weights">
<span class="sig-name descname"><span class="pre">slot_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlots" title="reagent.ope.estimators.slate_estimators.SlateSlots"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlots</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlotValues" title="reagent.ope.estimators.slate_estimators.SlateSlotValues"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlotValues</span></a></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.DCGSlateMetric.slot_weights" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.DMEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.slate_estimators.</span></span><span class="sig-name descname"><span class="pre">DMEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.types.Trainer" title="reagent.ope.estimators.types.Trainer"><span class="pre">reagent.ope.estimators.types.Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_sample_ratio</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.DMEstimator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateEstimator" title="reagent.ope.estimators.slate_estimators.SlateEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.slate_estimators.SlateEstimator</span></code></a></p>
<p>Direct Method estimator</p>
<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.DMEstimator.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateEstimatorInput" title="reagent.ope.estimators.slate_estimators.SlateEstimatorInput"><span class="pre">reagent.ope.estimators.slate_estimators.SlateEstimatorInput</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.estimator.EstimatorResult" title="reagent.ope.estimators.estimator.EstimatorResult"><span class="pre">reagent.ope.estimators.estimator.EstimatorResult</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.DMEstimator.evaluate" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.DoublyRobustEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.slate_estimators.</span></span><span class="sig-name descname"><span class="pre">DoublyRobustEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.types.Trainer" title="reagent.ope.estimators.types.Trainer"><span class="pre">reagent.ope.estimators.types.Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_sample_ratio</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_clamper</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="reagent.ope.html#reagent.ope.utils.Clamper" title="reagent.ope.utils.Clamper"><span class="pre">reagent.ope.utils.Clamper</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.DoublyRobustEstimator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.slate_estimators.DMEstimator" title="reagent.ope.estimators.slate_estimators.DMEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.slate_estimators.DMEstimator</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.DoublyRobustEstimator.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateEstimatorInput" title="reagent.ope.estimators.slate_estimators.SlateEstimatorInput"><span class="pre">reagent.ope.estimators.slate_estimators.SlateEstimatorInput</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.estimator.EstimatorResult" title="reagent.ope.estimators.estimator.EstimatorResult"><span class="pre">reagent.ope.estimators.estimator.EstimatorResult</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.DoublyRobustEstimator.evaluate" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.ERRSlateMetric">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.slate_estimators.</span></span><span class="sig-name descname"><span class="pre">ERRSlateMetric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_reward</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.ERRSlateMetric" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateMetric" title="reagent.ope.estimators.slate_estimators.SlateMetric"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.slate_estimators.SlateMetric</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.ERRSlateMetric.slot_values">
<span class="sig-name descname"><span class="pre">slot_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rewards</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlotValues" title="reagent.ope.estimators.slate_estimators.SlateSlotValues"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlotValues</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlotValues" title="reagent.ope.estimators.slate_estimators.SlateSlotValues"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlotValues</span></a></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.ERRSlateMetric.slot_values" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.ERRSlateMetric.slot_weights">
<span class="sig-name descname"><span class="pre">slot_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlots" title="reagent.ope.estimators.slate_estimators.SlateSlots"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlots</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlotValues" title="reagent.ope.estimators.slate_estimators.SlateSlotValues"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlotValues</span></a></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.ERRSlateMetric.slot_weights" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.FrechetDistribution">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.slate_estimators.</span></span><span class="sig-name descname"><span class="pre">FrechetDistribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.FrechetDistribution" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.slate_estimators.RewardDistribution" title="reagent.ope.estimators.slate_estimators.RewardDistribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.slate_estimators.RewardDistribution</span></code></a></p>
<p>Frechet distribution</p>
<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.FrechetDistribution.distribution">
<span class="sig-name descname"><span class="pre">distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rewards</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.FrechetDistribution.distribution" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.FrechetDistribution.name">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.FrechetDistribution.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.IPSEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.slate_estimators.</span></span><span class="sig-name descname"><span class="pre">IPSEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weight_clamper</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="reagent.ope.html#reagent.ope.utils.Clamper" title="reagent.ope.utils.Clamper"><span class="pre">reagent.ope.utils.Clamper</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.IPSEstimator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateEstimator" title="reagent.ope.estimators.slate_estimators.SlateEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.slate_estimators.SlateEstimator</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.IPSEstimator.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateEstimatorInput" title="reagent.ope.estimators.slate_estimators.SlateEstimatorInput"><span class="pre">reagent.ope.estimators.slate_estimators.SlateEstimatorInput</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.estimator.EstimatorResult" title="reagent.ope.estimators.estimator.EstimatorResult"><span class="pre">reagent.ope.estimators.estimator.EstimatorResult</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.IPSEstimator.evaluate" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.LogSample">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.slate_estimators.</span></span><span class="sig-name descname"><span class="pre">LogSample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateContext" title="reagent.ope.estimators.slate_estimators.SlateContext"><span class="pre">reagent.ope.estimators.slate_estimators.SlateContext</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateMetric" title="reagent.ope.estimators.slate_estimators.SlateMetric"><span class="pre">reagent.ope.estimators.slate_estimators.SlateMetric</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_slate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.Slate" title="reagent.ope.estimators.slate_estimators.Slate"><span class="pre">reagent.ope.estimators.slate_estimators.Slate</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_reward</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_log_slate_probability</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_log_slot_item_probabilities</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlotItemProbabilities" title="reagent.ope.estimators.slate_estimators.SlateSlotItemProbabilities"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlotItemProbabilities</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_log_item_probabilities</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateItemProbabilities" title="reagent.ope.estimators.slate_estimators.SlateItemProbabilities"><span class="pre">reagent.ope.estimators.slate_estimators.SlateItemProbabilities</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_tgt_slate_probability</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_tgt_slot_item_probabilities</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlotItemProbabilities" title="reagent.ope.estimators.slate_estimators.SlateSlotItemProbabilities"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlotItemProbabilities</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_tgt_item_probabilities</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateItemProbabilities" title="reagent.ope.estimators.slate_estimators.SlateItemProbabilities"><span class="pre">reagent.ope.estimators.slate_estimators.SlateItemProbabilities</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ground_truth_reward</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slot_weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlotValues" title="reagent.ope.estimators.slate_estimators.SlateSlotValues"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlotValues</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slot_probabilities</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlotValues" title="reagent.ope.estimators.slate_estimators.SlateSlotValues"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlotValues</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateItemFeatures" title="reagent.ope.estimators.slate_estimators.SlateItemFeatures"><span class="pre">reagent.ope.estimators.slate_estimators.SlateItemFeatures</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.LogSample" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.LogSample.context">
<span class="sig-name descname"><span class="pre">context</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateContext" title="reagent.ope.estimators.slate_estimators.SlateContext"><span class="pre">reagent.ope.estimators.slate_estimators.SlateContext</span></a></em><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.LogSample.context" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.LogSample.ground_truth_reward">
<span class="sig-name descname"><span class="pre">ground_truth_reward</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">nan</span></em><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.LogSample.ground_truth_reward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.LogSample.item_features">
<span class="sig-name descname"><span class="pre">item_features</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateItemFeatures" title="reagent.ope.estimators.slate_estimators.SlateItemFeatures"><span class="pre">reagent.ope.estimators.slate_estimators.SlateItemFeatures</span></a><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.LogSample.item_features" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.LogSample.items">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">items</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateItems" title="reagent.ope.estimators.slate_estimators.SlateItems"><span class="pre">reagent.ope.estimators.slate_estimators.SlateItems</span></a></em><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.LogSample.items" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.LogSample.log_reward">
<span class="sig-name descname"><span class="pre">log_reward</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.LogSample.log_reward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.LogSample.log_slate">
<span class="sig-name descname"><span class="pre">log_slate</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.Slate" title="reagent.ope.estimators.slate_estimators.Slate"><span class="pre">reagent.ope.estimators.slate_estimators.Slate</span></a></em><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.LogSample.log_slate" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.LogSample.log_slate_probability">
<span class="sig-name descname"><span class="pre">log_slate_probability</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.Slate" title="reagent.ope.estimators.slate_estimators.Slate"><span class="pre">reagent.ope.estimators.slate_estimators.Slate</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.LogSample.log_slate_probability" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.LogSample.log_slot_item_expectations">
<span class="sig-name descname"><span class="pre">log_slot_item_expectations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlots" title="reagent.ope.estimators.slate_estimators.SlateSlots"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlots</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlotItemExpectations" title="reagent.ope.estimators.slate_estimators.SlateSlotItemExpectations"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlotItemExpectations</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.LogSample.log_slot_item_expectations" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.LogSample.metric">
<span class="sig-name descname"><span class="pre">metric</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateMetric" title="reagent.ope.estimators.slate_estimators.SlateMetric"><span class="pre">reagent.ope.estimators.slate_estimators.SlateMetric</span></a></em><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.LogSample.metric" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.LogSample.slot_probabilities">
<span class="sig-name descname"><span class="pre">slot_probabilities</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlotValues" title="reagent.ope.estimators.slate_estimators.SlateSlotValues"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlotValues</span></a><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.LogSample.slot_probabilities" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.LogSample.slot_weights">
<span class="sig-name descname"><span class="pre">slot_weights</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlotValues" title="reagent.ope.estimators.slate_estimators.SlateSlotValues"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlotValues</span></a><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.LogSample.slot_weights" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.LogSample.tgt_slate_probability">
<span class="sig-name descname"><span class="pre">tgt_slate_probability</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.LogSample.tgt_slate_probability" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.LogSample.tgt_slate_space">
<span class="sig-name descname"><span class="pre">tgt_slate_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlots" title="reagent.ope.estimators.slate_estimators.SlateSlots"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlots</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.types.TypeWrapper" title="reagent.ope.estimators.types.TypeWrapper"><span class="pre">reagent.ope.estimators.types.TypeWrapper</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.LogSample.tgt_slate_space" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.LogSample.tgt_slot_expectations">
<span class="sig-name descname"><span class="pre">tgt_slot_expectations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlots" title="reagent.ope.estimators.slate_estimators.SlateSlots"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlots</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlotItemExpectations" title="reagent.ope.estimators.slate_estimators.SlateSlotItemExpectations"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlotItemExpectations</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.LogSample.tgt_slot_expectations" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.LogSample.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.LogSample.validate" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.NDCGSlateMetric">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.slate_estimators.</span></span><span class="sig-name descname"><span class="pre">NDCGSlateMetric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item_rewards</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateItemValues" title="reagent.ope.estimators.slate_estimators.SlateItemValues"><span class="pre">reagent.ope.estimators.slate_estimators.SlateItemValues</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.NDCGSlateMetric" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.slate_estimators.DCGSlateMetric" title="reagent.ope.estimators.slate_estimators.DCGSlateMetric"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.slate_estimators.DCGSlateMetric</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.NDCGSlateMetric.slot_weights">
<span class="sig-name descname"><span class="pre">slot_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlots" title="reagent.ope.estimators.slate_estimators.SlateSlots"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlots</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlotValues" title="reagent.ope.estimators.slate_estimators.SlateSlotValues"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlotValues</span></a></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.NDCGSlateMetric.slot_weights" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.PBMEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.slate_estimators.</span></span><span class="sig-name descname"><span class="pre">PBMEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weight_clamper</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="reagent.ope.html#reagent.ope.utils.Clamper" title="reagent.ope.utils.Clamper"><span class="pre">reagent.ope.utils.Clamper</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.PBMEstimator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateEstimator" title="reagent.ope.estimators.slate_estimators.SlateEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.slate_estimators.SlateEstimator</span></code></a></p>
<p>Estimator from reference 1: Position-Based Click Model</p>
<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.PBMEstimator.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateEstimatorInput" title="reagent.ope.estimators.slate_estimators.SlateEstimatorInput"><span class="pre">reagent.ope.estimators.slate_estimators.SlateEstimatorInput</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.estimator.EstimatorResult" title="reagent.ope.estimators.estimator.EstimatorResult"><span class="pre">reagent.ope.estimators.estimator.EstimatorResult</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.PBMEstimator.evaluate" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.PassThruDistribution">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.slate_estimators.</span></span><span class="sig-name descname"><span class="pre">PassThruDistribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.PassThruDistribution" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.slate_estimators.RewardDistribution" title="reagent.ope.estimators.slate_estimators.RewardDistribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.slate_estimators.RewardDistribution</span></code></a></p>
<p>No-op distribution, probability determined by reward</p>
<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.PassThruDistribution.distribution">
<span class="sig-name descname"><span class="pre">distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rewards</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.PassThruDistribution.distribution" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.PassThruDistribution.name">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.PassThruDistribution.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.PseudoInverseEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.slate_estimators.</span></span><span class="sig-name descname"><span class="pre">PseudoInverseEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weight_clamper</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="reagent.ope.html#reagent.ope.utils.Clamper" title="reagent.ope.utils.Clamper"><span class="pre">reagent.ope.utils.Clamper</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.PseudoInverseEstimator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateEstimator" title="reagent.ope.estimators.slate_estimators.SlateEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.slate_estimators.SlateEstimator</span></code></a></p>
<p>Estimator from reference 2</p>
<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.PseudoInverseEstimator.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateEstimatorInput" title="reagent.ope.estimators.slate_estimators.SlateEstimatorInput"><span class="pre">reagent.ope.estimators.slate_estimators.SlateEstimatorInput</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.estimator.EstimatorResult" title="reagent.ope.estimators.estimator.EstimatorResult"><span class="pre">reagent.ope.estimators.estimator.EstimatorResult</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.PseudoInverseEstimator.evaluate" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.RankingDistribution">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.slate_estimators.</span></span><span class="sig-name descname"><span class="pre">RankingDistribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-</span> <span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.RankingDistribution" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.slate_estimators.RewardDistribution" title="reagent.ope.estimators.slate_estimators.RewardDistribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.slate_estimators.RewardDistribution</span></code></a></p>
<p>Ranking distribution according to <a class="reference external" href="https://arxiv.org/abs/1605.04812">https://arxiv.org/abs/1605.04812</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.RankingDistribution.distribution">
<span class="sig-name descname"><span class="pre">distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rewards</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.RankingDistribution.distribution" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.RankingDistribution.name">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.RankingDistribution.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.RewardDistribution">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.slate_estimators.</span></span><span class="sig-name descname"><span class="pre">RewardDistribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.RewardDistribution" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Return customized probability distribution according to rewards</p>
<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.RewardDistribution.distribution">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rewards</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.RewardDistribution.distribution" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.RewardDistribution.name">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.RewardDistribution.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.Slate">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.slate_estimators.</span></span><span class="sig-name descname"><span class="pre">Slate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">MutableMapping</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.types.TypeWrapper" title="reagent.ope.estimators.types.TypeWrapper"><span class="pre">reagent.ope.estimators.types.TypeWrapper</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">reagent.ope.estimators.types.ValueType</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">MutableSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">reagent.ope.estimators.types.ValueType</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.Slate" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlotObjects" title="reagent.ope.estimators.slate_estimators.SlateSlotObjects"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlotObjects</span></code></a>[<a class="reference internal" href="#reagent.ope.estimators.types.TypeWrapper" title="reagent.ope.estimators.types.TypeWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.types.TypeWrapper</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code>]]]</p>
<p>Class represents a slate: map from slots to items/docs</p>
<dl class="py property">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.Slate.items">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">items</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.types.TypeWrapper" title="reagent.ope.estimators.types.TypeWrapper"><span class="pre">reagent.ope.estimators.types.TypeWrapper</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.Slate.items" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.Slate.one_hots">
<span class="sig-name descname"><span class="pre">one_hots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">items</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateItems" title="reagent.ope.estimators.slate_estimators.SlateItems"><span class="pre">reagent.ope.estimators.slate_estimators.SlateItems</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.Slate.one_hots" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.Slate.slot_features">
<span class="sig-name descname"><span class="pre">slot_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateItemFeatures" title="reagent.ope.estimators.slate_estimators.SlateItemFeatures"><span class="pre">reagent.ope.estimators.slate_estimators.SlateItemFeatures</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlotFeatures" title="reagent.ope.estimators.slate_estimators.SlateSlotFeatures"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlotFeatures</span></a></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.Slate.slot_features" title="Permalink to this definition"></a></dt>
<dd><p>Map items in the slate to given values
:param item_values: Map from all items to some values</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>List of values in the slate</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.Slate.slot_values">
<span class="sig-name descname"><span class="pre">slot_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateItemValues" title="reagent.ope.estimators.slate_estimators.SlateItemValues"><span class="pre">reagent.ope.estimators.slate_estimators.SlateItemValues</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlotValues" title="reagent.ope.estimators.slate_estimators.SlateSlotValues"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlotValues</span></a></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.Slate.slot_values" title="Permalink to this definition"></a></dt>
<dd><p>Map items in the slate to given values
:param item_values: Map from all items to some values</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>List of values in the slate</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateContext">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.slate_estimators.</span></span><span class="sig-name descname"><span class="pre">SlateContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.types.TypeWrapper" title="reagent.ope.estimators.types.TypeWrapper"><span class="pre">reagent.ope.estimators.types.TypeWrapper</span></a><span class="p"><span class="pre">[</span></span><span class="pre">typing.Union</span><span class="p"><span class="pre">[</span></span><span class="pre">typing.Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">typing.Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">typing.Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlots" title="reagent.ope.estimators.slate_estimators.SlateSlots"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlots</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">object</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateContext" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateContext.params">
<span class="sig-name descname"><span class="pre">params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">object</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateContext.params" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateContext.query">
<span class="sig-name descname"><span class="pre">query</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#reagent.ope.estimators.types.TypeWrapper" title="reagent.ope.estimators.types.TypeWrapper"><span class="pre">reagent.ope.estimators.types.TypeWrapper</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateContext.query" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateContext.slots">
<span class="sig-name descname"><span class="pre">slots</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlots" title="reagent.ope.estimators.slate_estimators.SlateSlots"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlots</span></a></em><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateContext.slots" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.slate_estimators.</span></span><span class="sig-name descname"><span class="pre">SlateEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateEstimator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.estimator.Estimator" title="reagent.ope.estimators.estimator.Estimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.estimator.Estimator</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateEstimatorInput">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.slate_estimators.</span></span><span class="sig-name descname"><span class="pre">SlateEstimatorInput</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.LogSample" title="reagent.ope.estimators.slate_estimators.LogSample"><span class="pre">reagent.ope.estimators.slate_estimators.LogSample</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateEstimatorInput" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateEstimatorInput.samples">
<span class="sig-name descname"><span class="pre">samples</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.LogSample" title="reagent.ope.estimators.slate_estimators.LogSample"><span class="pre">reagent.ope.estimators.slate_estimators.LogSample</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateEstimatorInput.samples" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateEstimatorInput.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateEstimatorInput.validate" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateItemFeatures">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.slate_estimators.</span></span><span class="sig-name descname"><span class="pre">SlateItemFeatures</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.types.TypeWrapper" title="reagent.ope.estimators.types.TypeWrapper"><span class="pre">reagent.ope.estimators.types.TypeWrapper</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateItemFeatures" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.types.Objects" title="reagent.ope.estimators.types.Objects"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.types.Objects</span></code></a>[<a class="reference internal" href="#reagent.ope.estimators.types.TypeWrapper" title="reagent.ope.estimators.types.TypeWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.types.TypeWrapper</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code>]], <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code>]</p>
<dl class="py property">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateItemFeatures.items">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">items</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateItems" title="reagent.ope.estimators.slate_estimators.SlateItems"><span class="pre">reagent.ope.estimators.slate_estimators.SlateItems</span></a></em><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateItemFeatures.items" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateItemProbabilities">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.slate_estimators.</span></span><span class="sig-name descname"><span class="pre">SlateItemProbabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.types.TypeWrapper" title="reagent.ope.estimators.types.TypeWrapper"><span class="pre">reagent.ope.estimators.types.TypeWrapper</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">greedy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateItemProbabilities" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateItemValues" title="reagent.ope.estimators.slate_estimators.SlateItemValues"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.slate_estimators.SlateItemValues</span></code></a></p>
<p>Probabilities of each item being selected into the slate</p>
<dl class="py property">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateItemProbabilities.is_deterministic">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_deterministic</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateItemProbabilities.is_deterministic" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateItemProbabilities.sample_slate">
<span class="sig-name descname"><span class="pre">sample_slate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlots" title="reagent.ope.estimators.slate_estimators.SlateSlots"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlots</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.Slate" title="reagent.ope.estimators.slate_estimators.Slate"><span class="pre">reagent.ope.estimators.slate_estimators.Slate</span></a></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateItemProbabilities.sample_slate" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateItemProbabilities.slate_probability">
<span class="sig-name descname"><span class="pre">slate_probability</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.Slate" title="reagent.ope.estimators.slate_estimators.Slate"><span class="pre">reagent.ope.estimators.slate_estimators.Slate</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateItemProbabilities.slate_probability" title="Permalink to this definition"></a></dt>
<dd><p>Calculate probability of a slate under this distribution
:param slate:</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>probability</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateItemProbabilities.slate_space">
<span class="sig-name descname"><span class="pre">slate_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlots" title="reagent.ope.estimators.slate_estimators.SlateSlots"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlots</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.types.TypeWrapper" title="reagent.ope.estimators.types.TypeWrapper"><span class="pre">reagent.ope.estimators.types.TypeWrapper</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateItemProbabilities.slate_space" title="Permalink to this definition"></a></dt>
<dd><p>Return all possible slates and their probabilities</p>
<p>The algorithm is similar to <code class="xref py py-func docutils literal notranslate"><span class="pre">_calculate_expectations()</span></code>, but has
less value to cache thus save both space and computation
:param slots: slots to be filled
:param max_size: max number of samples to be returned</p>
<blockquote>
<div><p>&lt;= 0 return all samples</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateItemProbabilities.slot_item_expectations">
<span class="sig-name descname"><span class="pre">slot_item_expectations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlots" title="reagent.ope.estimators.slate_estimators.SlateSlots"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlots</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlotItemExpectations" title="reagent.ope.estimators.slate_estimators.SlateSlotItemExpectations"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlotItemExpectations</span></a></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateItemProbabilities.slot_item_expectations" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateItemValues">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.slate_estimators.</span></span><span class="sig-name descname"><span class="pre">SlateItemValues</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">reagent.ope.estimators.types.KeyType</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateItemValues" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.types.Values" title="reagent.ope.estimators.types.Values"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.types.Values</span></code></a>[<a class="reference internal" href="#reagent.ope.estimators.types.TypeWrapper" title="reagent.ope.estimators.types.TypeWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.types.TypeWrapper</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code>]]]</p>
<dl class="py property">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateItemValues.items">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">items</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateItems" title="reagent.ope.estimators.slate_estimators.SlateItems"><span class="pre">reagent.ope.estimators.slate_estimators.SlateItems</span></a></em><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateItemValues.items" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateItems">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.slate_estimators.</span></span><span class="sig-name descname"><span class="pre">SlateItems</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">items</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">reagent.ope.estimators.types.ValueType</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateItems" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.types.Items" title="reagent.ope.estimators.types.Items"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.types.Items</span></code></a>[<a class="reference internal" href="#reagent.ope.estimators.types.TypeWrapper" title="reagent.ope.estimators.types.TypeWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.types.TypeWrapper</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code>]]]</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateMetric">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.slate_estimators.</span></span><span class="sig-name descname"><span class="pre">SlateMetric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateMetric" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Metric calculator for a slate: weights (dot) rewards</p>
<p>Base class is just sum of the all item rewards</p>
<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateMetric.calculate_reward">
<span class="sig-name descname"><span class="pre">calculate_reward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlots" title="reagent.ope.estimators.slate_estimators.SlateSlots"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlots</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rewards</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlotValues" title="reagent.ope.estimators.slate_estimators.SlateSlotValues"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlotValues</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slot_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlotValues" title="reagent.ope.estimators.slate_estimators.SlateSlotValues"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlotValues</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slot_weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlotValues" title="reagent.ope.estimators.slate_estimators.SlateSlotValues"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlotValues</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateMetric.calculate_reward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateMetric.slot_values">
<span class="sig-name descname"><span class="pre">slot_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rewards</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlotValues" title="reagent.ope.estimators.slate_estimators.SlateSlotValues"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlotValues</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlotValues" title="reagent.ope.estimators.slate_estimators.SlateSlotValues"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlotValues</span></a></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateMetric.slot_values" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateMetric.slot_weights">
<span class="sig-name descname"><span class="pre">slot_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlots" title="reagent.ope.estimators.slate_estimators.SlateSlots"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlots</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlotValues" title="reagent.ope.estimators.slate_estimators.SlateSlotValues"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlotValues</span></a></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateMetric.slot_weights" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.slate_estimators.</span></span><span class="sig-name descname"><span class="pre">SlateModel</span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Model providing item relevance/reward, slot examination (click) distribution</p>
<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateModel.item_rewards">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">item_rewards</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateContext" title="reagent.ope.estimators.slate_estimators.SlateContext"><span class="pre">reagent.ope.estimators.slate_estimators.SlateContext</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateItemValues" title="reagent.ope.estimators.slate_estimators.SlateItemValues"><span class="pre">reagent.ope.estimators.slate_estimators.SlateItemValues</span></a></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateModel.item_rewards" title="Permalink to this definition"></a></dt>
<dd><p>Returns each item’s relevance under the context
:param context:</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Item relevances</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateModel.slot_probabilities">
<span class="sig-name descname"><span class="pre">slot_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateContext" title="reagent.ope.estimators.slate_estimators.SlateContext"><span class="pre">reagent.ope.estimators.slate_estimators.SlateContext</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlotValues" title="reagent.ope.estimators.slate_estimators.SlateSlotValues"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlotValues</span></a></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateModel.slot_probabilities" title="Permalink to this definition"></a></dt>
<dd><p>Returns each slot/positions’s probability independent of showing item,
used in PBM estimator
:param context:</p>
<p>Returns:</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlatePolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.slate_estimators.</span></span><span class="sig-name descname"><span class="pre">SlatePolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlatePolicy" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Policy interface</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateSlotFeatures">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.slate_estimators.</span></span><span class="sig-name descname"><span class="pre">SlateSlotFeatures</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">MutableMapping</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.types.TypeWrapper" title="reagent.ope.estimators.types.TypeWrapper"><span class="pre">reagent.ope.estimators.types.TypeWrapper</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">reagent.ope.estimators.types.ValueType</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">MutableSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">reagent.ope.estimators.types.ValueType</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateSlotFeatures" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlotObjects" title="reagent.ope.estimators.slate_estimators.SlateSlotObjects"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlotObjects</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code>]</p>
<dl class="py property">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateSlotFeatures.features">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">features</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></em><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateSlotFeatures.features" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateSlotItemExpectations">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.slate_estimators.</span></span><span class="sig-name descname"><span class="pre">SlateSlotItemExpectations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">MutableMapping</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.types.TypeWrapper" title="reagent.ope.estimators.types.TypeWrapper"><span class="pre">reagent.ope.estimators.types.TypeWrapper</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateItemValues" title="reagent.ope.estimators.slate_estimators.SlateItemValues"><span class="pre">reagent.ope.estimators.slate_estimators.SlateItemValues</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">MutableSequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateItemValues" title="reagent.ope.estimators.slate_estimators.SlateItemValues"><span class="pre">reagent.ope.estimators.slate_estimators.SlateItemValues</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateSlotItemExpectations" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlotItemValues" title="reagent.ope.estimators.slate_estimators.SlateSlotItemValues"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlotItemValues</span></code></a></p>
<dl class="py property">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateSlotItemExpectations.expectations">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">expectations</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateItemValues" title="reagent.ope.estimators.slate_estimators.SlateItemValues"><span class="pre">reagent.ope.estimators.slate_estimators.SlateItemValues</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateSlotItemExpectations.expectations" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateSlotItemExpectations.expected_rewards">
<span class="sig-name descname"><span class="pre">expected_rewards</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item_rewards</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateItemValues" title="reagent.ope.estimators.slate_estimators.SlateItemValues"><span class="pre">reagent.ope.estimators.slate_estimators.SlateItemValues</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlotValues" title="reagent.ope.estimators.slate_estimators.SlateSlotValues"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlotValues</span></a></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateSlotItemExpectations.expected_rewards" title="Permalink to this definition"></a></dt>
<dd><p>Calculate expected relevances of each slot, given each item’s
relevances, under this distribution
:param item_rewards:
:param device:</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Map of slots to their expected relevance</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateSlotItemProbabilities">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.slate_estimators.</span></span><span class="sig-name descname"><span class="pre">SlateSlotItemProbabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">MutableMapping</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.types.TypeWrapper" title="reagent.ope.estimators.types.TypeWrapper"><span class="pre">reagent.ope.estimators.types.TypeWrapper</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateItemValues" title="reagent.ope.estimators.slate_estimators.SlateItemValues"><span class="pre">reagent.ope.estimators.slate_estimators.SlateItemValues</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">MutableSequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateItemValues" title="reagent.ope.estimators.slate_estimators.SlateItemValues"><span class="pre">reagent.ope.estimators.slate_estimators.SlateItemValues</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">greedy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateSlotItemProbabilities" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlotItemValues" title="reagent.ope.estimators.slate_estimators.SlateSlotItemValues"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlotItemValues</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateSlotItemProbabilities.sample_slate">
<span class="sig-name descname"><span class="pre">sample_slate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlots" title="reagent.ope.estimators.slate_estimators.SlateSlots"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlots</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.Slate" title="reagent.ope.estimators.slate_estimators.Slate"><span class="pre">reagent.ope.estimators.slate_estimators.Slate</span></a></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateSlotItemProbabilities.sample_slate" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateSlotItemProbabilities.slate_probability">
<span class="sig-name descname"><span class="pre">slate_probability</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.Slate" title="reagent.ope.estimators.slate_estimators.Slate"><span class="pre">reagent.ope.estimators.slate_estimators.Slate</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateSlotItemProbabilities.slate_probability" title="Permalink to this definition"></a></dt>
<dd><p>Calculate probability of a slate under this distribution
:param slate:</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>probability</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateSlotItemProbabilities.slot_item_expectations">
<span class="sig-name descname"><span class="pre">slot_item_expectations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20000</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlotItemExpectations" title="reagent.ope.estimators.slate_estimators.SlateSlotItemExpectations"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlotItemExpectations</span></a></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateSlotItemProbabilities.slot_item_expectations" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateSlotItemValues">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.slate_estimators.</span></span><span class="sig-name descname"><span class="pre">SlateSlotItemValues</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">MutableMapping</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.types.TypeWrapper" title="reagent.ope.estimators.types.TypeWrapper"><span class="pre">reagent.ope.estimators.types.TypeWrapper</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateItemValues" title="reagent.ope.estimators.slate_estimators.SlateItemValues"><span class="pre">reagent.ope.estimators.slate_estimators.SlateItemValues</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">MutableSequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateItemValues" title="reagent.ope.estimators.slate_estimators.SlateItemValues"><span class="pre">reagent.ope.estimators.slate_estimators.SlateItemValues</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateSlotItemValues" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlotObjects" title="reagent.ope.estimators.slate_estimators.SlateSlotObjects"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlotObjects</span></code></a>[<a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateItemValues" title="reagent.ope.estimators.slate_estimators.SlateItemValues"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.slate_estimators.SlateItemValues</span></code></a>]</p>
<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateSlotItemValues.values_tensor">
<span class="sig-name descname"><span class="pre">values_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateSlotItemValues.values_tensor" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateSlotObjects">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.slate_estimators.</span></span><span class="sig-name descname"><span class="pre">SlateSlotObjects</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">MutableMapping</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.types.TypeWrapper" title="reagent.ope.estimators.types.TypeWrapper"><span class="pre">reagent.ope.estimators.types.TypeWrapper</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">reagent.ope.estimators.types.ValueType</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">MutableSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">reagent.ope.estimators.types.ValueType</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateSlotObjects" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.types.Objects" title="reagent.ope.estimators.types.Objects"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.types.Objects</span></code></a>[<a class="reference internal" href="#reagent.ope.estimators.types.TypeWrapper" title="reagent.ope.estimators.types.TypeWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.types.TypeWrapper</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code>]], <code class="xref py py-obj docutils literal notranslate"><span class="pre">reagent.ope.estimators.types.ValueType</span></code>]</p>
<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateSlotObjects.fill">
<span class="sig-name descname"><span class="pre">fill</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">reagent.ope.estimators.types.ValueType</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.types.TypeWrapper" title="reagent.ope.estimators.types.TypeWrapper"><span class="pre">reagent.ope.estimators.types.TypeWrapper</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">reagent.ope.estimators.types.ValueType</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">reagent.ope.estimators.types.ValueType</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateSlotObjects.fill" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateSlotObjects.objects">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">objects</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">reagent.ope.estimators.types.ValueType</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateSlotObjects.objects" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateSlotObjects.slots">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">slots</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlots" title="reagent.ope.estimators.slate_estimators.SlateSlots"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlots</span></a></em><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateSlotObjects.slots" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateSlotValues">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.slate_estimators.</span></span><span class="sig-name descname"><span class="pre">SlateSlotValues</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">reagent.ope.estimators.types.KeyType</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateSlotValues" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.types.Values" title="reagent.ope.estimators.types.Values"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.types.Values</span></code></a>[<a class="reference internal" href="#reagent.ope.estimators.types.TypeWrapper" title="reagent.ope.estimators.types.TypeWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.types.TypeWrapper</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code>]]]</p>
<p>Map from a slot to a value</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateSlots">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.slate_estimators.</span></span><span class="sig-name descname"><span class="pre">SlateSlots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">items</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">reagent.ope.estimators.types.ValueType</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateSlots" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.types.Items" title="reagent.ope.estimators.types.Items"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.types.Items</span></code></a>[<a class="reference internal" href="#reagent.ope.estimators.types.TypeWrapper" title="reagent.ope.estimators.types.TypeWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.types.TypeWrapper</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code>]]]</p>
<p>List of slot</p>
<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.SlateSlots.fill">
<span class="sig-name descname"><span class="pre">fill</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.types.TypeWrapper" title="reagent.ope.estimators.types.TypeWrapper"><span class="pre">reagent.ope.estimators.types.TypeWrapper</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlotValues" title="reagent.ope.estimators.slate_estimators.SlateSlotValues"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlotValues</span></a></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.SlateSlots.fill" title="Permalink to this definition"></a></dt>
<dd><p>Map slots to given values
:param values: given values</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Map from slots to given values</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.is_to_calculate_expectation">
<span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.slate_estimators.</span></span><span class="sig-name descname"><span class="pre">is_to_calculate_expectation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slate_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.is_to_calculate_expectation" title="Permalink to this definition"></a></dt>
<dd><p>Switch between calculating and sampling expectations, balanced by execution
time and accuracy
:returns: True to calculate</p>
<blockquote>
<div><p>False to sample</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.make_slate">
<span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.slate_estimators.</span></span><span class="sig-name descname"><span class="pre">make_slate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlots" title="reagent.ope.estimators.slate_estimators.SlateSlots"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlots</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">items</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.types.TypeWrapper" title="reagent.ope.estimators.types.TypeWrapper"><span class="pre">reagent.ope.estimators.types.TypeWrapper</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.Slate" title="reagent.ope.estimators.slate_estimators.Slate"><span class="pre">reagent.ope.estimators.slate_estimators.Slate</span></a></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.make_slate" title="Permalink to this definition"></a></dt>
<dd><p>Assign items to slots to make a slate</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reagent.ope.estimators.slate_estimators.make_slot_item_distributions">
<span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.slate_estimators.</span></span><span class="sig-name descname"><span class="pre">make_slot_item_distributions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlots" title="reagent.ope.estimators.slate_estimators.SlateSlots"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlots</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dists</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateItemValues" title="reagent.ope.estimators.slate_estimators.SlateItemValues"><span class="pre">reagent.ope.estimators.slate_estimators.SlateItemValues</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#reagent.ope.estimators.slate_estimators.SlateSlotItemExpectations" title="reagent.ope.estimators.slate_estimators.SlateSlotItemExpectations"><span class="pre">reagent.ope.estimators.slate_estimators.SlateSlotItemExpectations</span></a></span></span><a class="headerlink" href="#reagent.ope.estimators.slate_estimators.make_slot_item_distributions" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-reagent.ope.estimators.types">
<span id="reagent-ope-estimators-types-module"></span><h2>reagent.ope.estimators.types module<a class="headerlink" href="#module-reagent.ope.estimators.types" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.ActionDistribution">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.types.</span></span><span class="sig-name descname"><span class="pre">ActionDistribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">reagent.ope.estimators.types.KeyType</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.types.ActionDistribution" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.types.Values" title="reagent.ope.estimators.types.Values"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.types.Values</span></code></a>[<a class="reference internal" href="#reagent.ope.estimators.types.TypeWrapper" title="reagent.ope.estimators.types.TypeWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.types.TypeWrapper</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code>]]]</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.ActionSpace">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.types.</span></span><span class="sig-name descname"><span class="pre">ActionSpace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">items</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">reagent.ope.estimators.types.ValueType</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.types.ActionSpace" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.types.Items" title="reagent.ope.estimators.types.Items"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.types.Items</span></code></a>[<a class="reference internal" href="#reagent.ope.estimators.types.TypeWrapper" title="reagent.ope.estimators.types.TypeWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.types.TypeWrapper</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code>]]]</p>
<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.ActionSpace.distribution">
<span class="sig-name descname"><span class="pre">distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.types.TypeWrapper" title="reagent.ope.estimators.types.TypeWrapper"><span class="pre">reagent.ope.estimators.types.TypeWrapper</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#reagent.ope.estimators.types.ActionDistribution" title="reagent.ope.estimators.types.ActionDistribution"><span class="pre">reagent.ope.estimators.types.ActionDistribution</span></a></span></span><a class="headerlink" href="#reagent.ope.estimators.types.ActionSpace.distribution" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.ActionSpace.space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#reagent.ope.estimators.types.TypeWrapper" title="reagent.ope.estimators.types.TypeWrapper"><span class="pre">reagent.ope.estimators.types.TypeWrapper</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#reagent.ope.estimators.types.ActionSpace.space" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.Items">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.types.</span></span><span class="sig-name descname"><span class="pre">Items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">items</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">reagent.ope.estimators.types.ValueType</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.types.Items" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">reagent.ope.estimators.types.ValueType</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>List of items</p>
<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.Items.fill">
<span class="sig-name descname"><span class="pre">fill</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">reagent.ope.estimators.types.ValueType</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">reagent.ope.estimators.types.ValueType</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#reagent.ope.estimators.types.Items.fill" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.Items.index_of">
<span class="sig-name descname"><span class="pre">index_of</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">reagent.ope.estimators.types.ValueType</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#reagent.ope.estimators.types.Items.index_of" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.Items.is_sequence">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_sequence</span></span><a class="headerlink" href="#reagent.ope.estimators.types.Items.is_sequence" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.Objects">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.types.</span></span><span class="sig-name descname"><span class="pre">Objects</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">reagent.ope.estimators.types.KeyType</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">reagent.ope.estimators.types.ValueType</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">reagent.ope.estimators.types.ValueType</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.types.Objects" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">reagent.ope.estimators.types.KeyType</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">reagent.ope.estimators.types.ValueType</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Generic class for a map from item to its value.
It supports [] indexing, and iterator protocol</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.Objects.items">
<span class="sig-name descname"><span class="pre">items</span></span><a class="headerlink" href="#reagent.ope.estimators.types.Objects.items" title="Permalink to this definition"></a></dt>
<dd><p>list of items</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.Objects.values">
<span class="sig-name descname"><span class="pre">values</span></span><a class="headerlink" href="#reagent.ope.estimators.types.Objects.values" title="Permalink to this definition"></a></dt>
<dd><p>list of their values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.Objects.index_of">
<span class="sig-name descname"><span class="pre">index_of</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">reagent.ope.estimators.types.KeyType</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#reagent.ope.estimators.types.Objects.index_of" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.Objects.is_sequence">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_sequence</span></span><a class="headerlink" href="#reagent.ope.estimators.types.Objects.is_sequence" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.Objects.keys">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">keys</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">reagent.ope.estimators.types.KeyType</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#reagent.ope.estimators.types.Objects.keys" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id0">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">values</span></span><a class="headerlink" href="#id0" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.Policy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.types.</span></span><span class="sig-name descname"><span class="pre">Policy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action_space</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.types.ActionSpace" title="reagent.ope.estimators.types.ActionSpace"><span class="pre">reagent.ope.estimators.types.ActionSpace</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.types.Policy" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Policy interface</p>
<dl class="py property">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.Policy.action_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">action_space</span></span><a class="headerlink" href="#reagent.ope.estimators.types.Policy.action_space" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.PredictResults">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.types.</span></span><span class="sig-name descname"><span class="pre">PredictResults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scores</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">probabilities</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.types.PredictResults" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.PredictResults.predictions">
<span class="sig-name descname"><span class="pre">predictions</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#reagent.ope.estimators.types.PredictResults.predictions" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.PredictResults.probabilities">
<span class="sig-name descname"><span class="pre">probabilities</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#reagent.ope.estimators.types.PredictResults.probabilities" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.PredictResults.scores">
<span class="sig-name descname"><span class="pre">scores</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></em><a class="headerlink" href="#reagent.ope.estimators.types.PredictResults.scores" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.Trainer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.types.</span></span><span class="sig-name descname"><span class="pre">Trainer</span></span><a class="headerlink" href="#reagent.ope.estimators.types.Trainer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<dl class="py property">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.Trainer.is_trained">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_trained</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#reagent.ope.estimators.types.Trainer.is_trained" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.Trainer.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.types.Trainer.load_model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.Trainer.name">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#reagent.ope.estimators.types.Trainer.name" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.Trainer.predict">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#reagent.ope.estimators.types.PredictResults" title="reagent.ope.estimators.types.PredictResults"><span class="pre">reagent.ope.estimators.types.PredictResults</span></a></span></span><a class="headerlink" href="#reagent.ope.estimators.types.Trainer.predict" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.Trainer.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.types.Trainer.reset" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.Trainer.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.types.Trainer.save_model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.Trainer.score">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#reagent.ope.estimators.types.Trainer.score" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.Trainer.train">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#reagent.ope.estimators.types.TrainingData" title="reagent.ope.estimators.types.TrainingData"><span class="pre">reagent.ope.estimators.types.TrainingData</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.types.Trainer.train" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.TrainingData">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.types.</span></span><span class="sig-name descname"><span class="pre">TrainingData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.types.TrainingData" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.TrainingData.train_weight">
<span class="sig-name descname"><span class="pre">train_weight</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#reagent.ope.estimators.types.TrainingData.train_weight" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.TrainingData.train_x">
<span class="sig-name descname"><span class="pre">train_x</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></em><a class="headerlink" href="#reagent.ope.estimators.types.TrainingData.train_x" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.TrainingData.train_y">
<span class="sig-name descname"><span class="pre">train_y</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></em><a class="headerlink" href="#reagent.ope.estimators.types.TrainingData.train_y" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.TrainingData.validation_weight">
<span class="sig-name descname"><span class="pre">validation_weight</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#reagent.ope.estimators.types.TrainingData.validation_weight" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.TrainingData.validation_x">
<span class="sig-name descname"><span class="pre">validation_x</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></em><a class="headerlink" href="#reagent.ope.estimators.types.TrainingData.validation_x" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.TrainingData.validation_y">
<span class="sig-name descname"><span class="pre">validation_y</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">torch.Tensor</span></em><a class="headerlink" href="#reagent.ope.estimators.types.TrainingData.validation_y" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.TypeWrapper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.types.</span></span><span class="sig-name descname"><span class="pre">TypeWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">~</span> <span class="pre">ValueType</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.types.TypeWrapper" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">reagent.ope.estimators.types.ValueType</span></code>]</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.TypeWrapper.value">
<span class="sig-name descname"><span class="pre">value</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">reagent.ope.estimators.types.ValueType</span></em><a class="headerlink" href="#reagent.ope.estimators.types.TypeWrapper.value" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.Values">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.types.</span></span><span class="sig-name descname"><span class="pre">Values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">reagent.ope.estimators.types.KeyType</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.types.Values" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reagent.ope.estimators.types.Objects" title="reagent.ope.estimators.types.Objects"><code class="xref py py-class docutils literal notranslate"><span class="pre">reagent.ope.estimators.types.Objects</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">reagent.ope.estimators.types.KeyType</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]</p>
<p>Generic class for a map from item to its value.
It supports [] indexing, and iterator protocol</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.Values.items">
<span class="sig-name descname"><span class="pre">items</span></span><a class="headerlink" href="#reagent.ope.estimators.types.Values.items" title="Permalink to this definition"></a></dt>
<dd><p>list of items</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.Values.values">
<span class="sig-name descname"><span class="pre">values</span></span><a class="headerlink" href="#reagent.ope.estimators.types.Values.values" title="Permalink to this definition"></a></dt>
<dd><p>list of their values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.Values.greedy">
<span class="sig-name descname"><span class="pre">greedy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">reagent.ope.estimators.types.KeyType</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#reagent.ope.estimators.types.Values.greedy" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.Values.probability">
<span class="sig-name descname"><span class="pre">probability</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">reagent.ope.estimators.types.ValueType</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#reagent.ope.estimators.types.Values.probability" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.Values.replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">reagent.ope.estimators.types.ValueType</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#reagent.ope.estimators.types.Values" title="reagent.ope.estimators.types.Values"><span class="pre">reagent.ope.estimators.types.Values</span></a></span></span><a class="headerlink" href="#reagent.ope.estimators.types.Values.replace" title="Permalink to this definition"></a></dt>
<dd><p>Replace current values with new values, and returns the new copy.
Current Values object is not changed</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>values</strong> – new value</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Values object with new values</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.Values.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">reagent.ope.estimators.types.KeyType</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#reagent.ope.estimators.types.Values.sample" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.Values.sort">
<span class="sig-name descname"><span class="pre">sort</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">descending</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">reagent.ope.estimators.types.KeyType</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#reagent.ope.estimators.types.Values.sort" title="Permalink to this definition"></a></dt>
<dd><p>Sort based on values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>descending</strong> – sorting order</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tuple of sorted indices and values</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reagent.ope.estimators.types.is_array">
<span class="sig-prename descclassname"><span class="pre">reagent.ope.estimators.types.</span></span><span class="sig-name descname"><span class="pre">is_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reagent.ope.estimators.types.is_array" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-reagent.ope.estimators">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-reagent.ope.estimators" title="Permalink to this headline"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="reagent.ope.datasets.html" class="btn btn-neutral float-left" title="reagent.ope.datasets package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="reagent.ope.test.html" class="btn btn-neutral float-right" title="reagent.ope.test package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Meta Platforms, Inc.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>